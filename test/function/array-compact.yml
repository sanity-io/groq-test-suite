name: "array::compact() function"

version: ">= 1.1"

tests:
- name: Basic
  query: |
    array::compact(~arr~)
  tests:
  # Mix of types
  - variables: {arr: '["a", 23, true]'}
    result: [a, 23, true]
  # Mix of types with null last
  - variables: {arr: '["a", 23, true, null]'}
    result: [a, 23, true]
  # Mix of types with null first
  - variables: {arr: '[null, "a", 23, true]'}
    result: [a, 23, true]
  # Mix of types with null in middle
  - variables: {arr: '["a", null, 23, true]'}
    result: [a, 23, true]
  # Empty
  - variables: {arr: '[]'}
    result: []
  # Just null
  - variables: {arr: '[null]'}
    result: []
  # Many nulls
  - variables: {arr: '[null, null, null, null]'}
    result: []

- name: Invalid
  query: |
    array::compact(~arr~)
  variables:
    arr:
    - '{}'
    - 'null'
    - '"x"'
    - '42'
    - 'true'
  result: null
